<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Chat Public â€“ Fondationâ€¯Backupâ€¯Spirituel</title>

  <!-- Google Ads -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7462273633598843" crossorigin="anonymous"></script>

  <!-- Styles globaux Fondation -->
  <style>
    :root{--bleu:#003366;--bleu-clair:#0055aa;--jaune:#ffcc00;--gris:#f5f7fa;--maxw:1100px}
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
    body{background:#fff;color:#333;line-height:1.6}
    a{text-decoration:none;color:inherit}
    header{background:var(--bleu);color:#fff;text-align:center;padding:18px 10px}
    header img{height:85px}
    header h1{margin-top:6px;font-size:2rem;font-weight:700}
    nav{background:var(--jaune);font-weight:bold}
    nav ul{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;list-style:none;padding:10px;white-space:nowrap}
    nav a{padding:10px 16px;border-radius:4px;color:var(--bleu);transition:.25s}
    nav a:hover,nav a.active{background:var(--bleu);color:#fff}
    li{position:relative}
    .dropdown-content{display:none;position:absolute;top:100%;left:0;background:var(--bleu);min-width:220px;border-radius:4px;z-index:99}
    .dropdown-content a{display:block;padding:10px 14px;color:#fff}
    .dropdown-content a:hover{background:var(--bleu-clair)}
    li.dropdown:hover .dropdown-content{display:block}
    section{max-width:var(--maxw);margin:auto;padding:50px 15px}
    h2{color:var(--bleu);text-align:center;margin-bottom:28px;font-size:2rem}
    footer{background:var(--bleu);color:#fff;text-align:center;padding:18px 10px;margin-top:60px}
    
    /* Zone Chat */
    .chat-container {
      max-width: 700px;
      margin: 0 auto;
      background: var(--gris);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #messages {
      border: 1px solid #ccc;
      padding: 15px;
      min-height: 200px;
      max-height: 400px;
      overflow-y: auto;
      background: #fff;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    #messages p {
      margin-bottom: 10px;
    }
    .chat-form input {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .chat-form button {
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      background-color: var(--bleu);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .chat-form button:hover {
      background-color: var(--bleu-clair);
    }

    @media(max-width:700px){
      header h1{font-size:1.5rem}
      nav ul{gap:6px}
    }
  </style>
</head>

<body>

<!-- â–‘â–‘ Header â–‘â–‘ -->
<header>
  <img src="logofobas.png" alt="Logo Fondation">
  <h1>FONDATION BACKUP SPIRITUEL</h1>
</header>

<!-- â–‘ Navigation â–‘ -->
<nav>
  <ul>
    <li><a href="index.html">Accueil</a></li>
    <li><a href="Qui-sommes-nous.html">Qui sommesâ€‘nous</a></li>
    <li><a href="Parrainez-nous.html">Parrainezâ€‘nous</a></li>
    <li><a href="suivi-ambassadeurs.html">Suivi Ambassadeurs</a></li>
    <li><a href="soumet-projet.html">Votre Projet Ici</a></li>
    <li><a href="eglises-nord-ouest-haiti.html">Ã‰glises en Action</a></li>
    <li class="dropdown">
      <a href="#">Autres â–¾</a>
      <ul class="dropdown-content">
        <li><a href="Nos-ambassadeurs.html">Visitez nos Ambassadeurs</a></li>
        <li><a href="Notre-ecole-d'informatique.html">Notre Ã‰cole d'Info.</a></li>
        <li><a href="Contact.html">Contact</a></li>
        <li><a href="Actualites.html">ActualitÃ©s</a></li>
        <li><a href="Blagues-et-histoires.html">Blagues & Histoires</a></li>
        <li><a href="Notre-programme-d'alphabetisation.html">Prog. d'AlphabÃ©tisation</a></li>
        <li><a href="Emission-Backup-Spirituel.html">Ã‰mission Backup Spirituel</a></li>
        <li><a href="Faire-un-don.html">Faire un don</a></li>
        <li><a href="Nos-actions.html">Nos actions</a></li>
        <li><a href="Politique-de-confidentialite.html">Politique de confidentialitÃ©</a></li>
        <li><a href="jeux-fobas.html">Jouez avec FOBAS</a></li>
      </ul>
    </li>
  </ul>
</nav>

<!-- â–‘ Contenu Chat Public â–‘ -->
<section>
  <h2>ðŸ’¬ Espace de Chat Public en Temps RÃ©el</h2>
  <div id="messages"></div>
  <input type="text" id="name" placeholder="Nom..." /><br />
  <input type="text" id="message" placeholder="Tapez votre message ici..." />
  <button onclick="sendMessage()">Envoyer</button>

  <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
  <script>
    const messagesDiv = document.getElementById("messages");

    function appendMessage(msg) {
      const p = document.createElement("p");
      p.innerText = `[${msg.timestamp}] ${msg.name}: ${msg.message}`;
      messagesDiv.appendChild(p);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    // Rechaje tout ansyen mesaj yo
    fetch("/messages/sync")
      .then(res => res.json())
      .then(data => data.forEach(appendMessage));

    // Voye nouvo mesaj
    function sendMessage() {
      const name = document.getElementById("name").value;
      const message = document.getElementById("message").value;
      const timestamp = new Date().toLocaleTimeString();

      fetch("/messages/new", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, message, timestamp }),
      });

      document.getElementById("message").value = "";
    }

    // Pusher pou resevwa an tan reyÃ¨l
    const pusher = new Pusher("50534b64465373224fa1", {
      cluster: "us2",
    });

    const channel = pusher.subscribe("chat");
    channel.bind("newMessage", function (data) {
      appendMessage(data);
    });
  </script>
</section>

<!-- â–‘ Footer â–‘ -->
<footer>
  Â© 2025 Fondation Backup Spirituel â€“ Tous droits rÃ©servÃ©s.
</footer>

<!-- â–‘ Script Firebase (modÃ¨n) â–‘ -->
<script type="module">
  // ðŸ”‘ Konfig Firebase ou a
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "VOTRE_API_KEY",
    authDomain: "VOTRE_PROJET.firebaseapp.com",
    databaseURL: "https://VOTRE_PROJET.firebaseio.com",
    projectId: "VOTRE_PROJET_ID",
    storageBucket: "VOTRE_PROJET.appspot.com",
    messagingSenderId: "VOTRE_ID",
    appId: "VOTRE_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const chatRef = ref(db, "public-chat");

  const messagesDiv = document.getElementById("messages");
  const chatForm = document.getElementById("chatForm");
  const input = document.getElementById("messageInput");

  chatForm.addEventListener("submit", e => {
    e.preventDefault();
    const msg = input.value.trim();
    if (msg) {
      push(chatRef, { text: msg, timestamp: Date.now() });
      input.value = "";
    }
  });

  onChildAdded(chatRef, snapshot => {
    const msg = snapshot.val();
    const p = document.createElement("p");
    p.textContent = msg.text;
    messagesDiv.appendChild(p);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  });
</script>

</body>
</html>
