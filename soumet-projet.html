<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#003366" />
  <meta name="description" content="Soumettez un projet √† la Fondation Backup Spirituel pour recevoir un soutien." />
  <title>Soumettre un Projet ‚Äì Fondation Backup Spirituel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    header { background: #003366; color: white; padding: 20px; text-align: center; }
    header img { max-height: 80px; display: block; margin: 0 auto 10px; }
    nav { background: #ffcc00; }
    nav ul { list-style: none; margin: 0; padding: 0; display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; }
    nav a { display: block; padding: 12px 20px; color: #003366; text-decoration: none; font-weight: bold; }
    nav a:hover { background: #003366; color: white; border-radius: 5px; }
    .dropdown-content { display: none; position: absolute; background: #ffcc00; border-radius: 5px; }
    .dropdown:hover .dropdown-content { display: block; }
    main { padding: 40px 20px; max-width: 1000px; margin: auto; }
    h2 { color: #003366; text-align: center; }
    form { background: #f9f9f9; padding: 20px; border-radius: 10px; }
    input, textarea, select { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #003366; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0055aa; }
    #etatForm { text-align: center; font-weight: bold; }
    footer { background: #003366; color: white; text-align: center; padding: 15px 0; margin-top: 40px; }
  </style>
</head>
<body>
  <header>
    <img src="logofobas.png" alt="Logo Fondation Backup Spirituel" />
    <h1>FONDATION BACKUP SPIRITUEL</h1>
  </header>

 <!-- ‚ñë Navigation ‚ñë -->
  <nav>
    <ul>
      <li><a href="index.html" class="active">Accueil</a></li>
      <li><a href="Qui-sommes-nous.html">Qui sommes‚Äënous</a></li>
      <li><a href="Parrainez-nous.html">Parrainez‚Äënous</a></li>
      <li><a href="suivi-ambassadeurs.html">Suivi Ambassadeurs</a></li>
      <li><a href="soumet-projet.html">Votre Projet Ici</a></li>
      <li><a href="eglises-nord-ouest-haiti.html">√âglises en Action</a></li>

      <li class="dropdown">
        <a href="#">Autres ‚ñæ</a>
        <ul class="dropdown-content">
          <li><a href="Nos-ambassadeurs.html">Visitez nos Ambassadeurs</a></li>
          <li><a href="Notre-ecole-d'informatique.html">Notre&nbsp;√âcole&nbsp;d'Info.</a></li>
          <li><a href="Contact.html">Contact</a></li>
          <li><a href="Actualites.html">Actualit√©s</a></li>
          <li><a href="Blagues-et-histoires.html">Blagues & Histoires</a></li>
          <li><a href="Notre-programme-d'alphabetisation.html">Notre&nbsp;Prog.&nbsp;d'Alphabetisation</a></li>
          <li><a href="Emission-Backup-Spirituel.html">√âmission Backup Spirituel</a></li>
          <li><a href="Faire-un-don.html">Faire un don</a></li>
          <li><a href="Nos-actions.html">Nos actions (d√©tail)</a></li>
          <li><a href="Politique-de-confidentialite.html">Politique de confidentialit√©</a></li>
          <li><a href="jeux-fobas.html">Jouez avec FOBAS</a></li>
        </ul>
      </li>
    </ul>
  </nav>
  
  <main>
    <h2>üå± Demande de Projet ‚Äì Fondation Backup Spirituel</h2>
    <p style="text-align:center; max-width: 800px; margin: auto;">
      Nous croyons que chaque r√™ve a de la valeur. Si vous avez une vision, un projet communautaire, social ou spirituel que vous d√©sirez r√©aliser mais vous manquez de moyens, cette page est pour vous.<br>
      <strong>La Fondation Backup Spirituel</strong> vous invite √† soumettre votre demande de projet. Ensemble, nous pouvons allumer l‚Äô√©tincelle d‚Äôun changement durable.
    </p>

    <form id="demandeForm">
      <input type="text" name="nom" placeholder="Nom complet" required />
      <input type="email" name="email" placeholder="Adresse email" required />
      <input type="tel" name="tel" placeholder="Num√©ro de t√©l√©phone" />
      <input type="text" name="titre" placeholder="Titre du projet" required />
      <textarea name="description" placeholder="D√©crivez votre projet en d√©tail..." rows="5" required></textarea>
      <textarea name="raison" placeholder="Pourquoi ce projet est-il important pour vous et votre communaut√© ?" rows="4"></textarea>
      <input type="text" name="localisation" placeholder="Localisation g√©ographique du projet" />
      <input type="text" name="budget" placeholder="Budget estimatif (optionnel)" />
      <select name="urgence">
        <option value="">Niveau d‚Äôurgence</option>
        <option value="Faible">Faible</option>
        <option value="Moyenne">Moyenne</option>
        <option value="√âlev√©e">√âlev√©e</option>
      </select>
      <button type="submit">Envoyer</button>
    </form>
    <p id="etatForm"></p>
  </main>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const soumetDate = new Date();
    const expirationDate = new Date();
    expirationDate.setFullYear(soumetDate.getFullYear() + 1);

    const formatDate = (d) => {
      return d.toLocaleDateString("fr-FR", {
        year: "numeric", month: "long", day: "numeric"
      });
    };

    const exempleProjet = `
      <section style="background:#eef6ff; padding:30px; border-radius:10px; margin-bottom:40px; border:1px solid #ccd;">
        <h3 style="color:#003366;">üìå Exemple de projet soumis</h3>
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/65/Chicken_farm_-_geograph.org.uk_-_5628397.jpg" 
             alt="Exemple poulailler communautaire" 
             style="max-width:100%; border-radius:8px; margin:10px 0;" />
        <p><strong>Nom complet :</strong> Fondation Backup Spirituel</p>
        <p><strong>Adresse email :</strong> infos@fondationbackupspirituel.com</p>
        <p><strong>Num√©ro de t√©l√©phone :</strong> +509 4605 7952</p>
        <p><strong>Titre du projet :</strong> D√©veloppement d‚Äôun Poulailler Communautaire Durable</p>
        <p><strong>Description :</strong> Ce projet vise √† cr√©er un espace de production de volailles au sein de la communaut√© de Mare Rouge. Le poulailler aura une capacit√© initiale de 300 poules pondeuses et sera g√©r√© par un comit√© local de jeunes et femmes en difficult√© √©conomique. Les ≈ìufs seront utilis√©s pour lutter contre la malnutrition et g√©n√©rer un revenu pour les familles impliqu√©es.</p>
        <p><strong>Pourquoi ce projet est important ?</strong><br>
        Le ch√¥mage, la malnutrition et l‚Äôexode rural sont des probl√®mes graves dans notre communaut√©. Ce poulailler offrira des opportunit√©s concr√®tes de formation, d‚Äôalimentation locale et de revenu imm√©diat pour les jeunes et m√®res c√©libataires.</p>
        <p><strong>Localisation :</strong> Mare Rouge, D√©partement du Nord-Ouest, Ha√Øti</p>
        <p><strong>Budget estimatif :</strong> 3 500 USD (achat poussins, construction, alimentation, mat√©riel sanitaire)</p>
        <p><strong>Niveau d‚Äôurgence :</strong> üö® √âlev√© ‚Äì d√©but demand√© d√®s le mois prochain</p>
        <p style="color:gray; font-size:0.9em;">
          ‚è≥ Soumis le <strong>${formatDate(soumetDate)}</strong> ‚Äì Expire le <strong>${formatDate(expirationDate)}</strong>
        </p>
      </section>
    `;

    const form = document.querySelector("form");
    if (form) {
      const wrapper = document.createElement("div");
      wrapper.innerHTML = exempleProjet;
      form.parentNode.insertBefore(wrapper, form);
    }
  });
</script>
  
  <footer>
    <p>&copy; 2025 Fondation Backup Spirituel. Tous droits r√©serv√©s.</p>
  </footer>

  <script>
  document.getElementById('demandeForm').addEventListener('submit', async function (e) {
    e.preventDefault();
    const etat = document.getElementById("etatForm");
    etat.textContent = "‚è≥ Ap voye... Tanpri tann...";
    const data = {
      access_key: "cd9e4473-a66b-4449-93aa-b489c32a7fbd",
      subject: "Nouvo Demande de Projet sou sit Fondation",
      email: "fondationbackupspirituel@gmail.com",
      name: this.nom.value,
      message: `
Nom: ${this.nom.value}
Email: ${this.email.value}
T√©l√©phone: ${this.tel.value}
Titre du projet: ${this.titre.value}
Description: ${this.description.value}
Raison: ${this.raison.value}
Localisation: ${this.localisation.value}
Budget: ${this.budget.value}
Urgence: ${this.urgence.value}`
    };

    try {
      const res = await fetch("https://api.web3forms.com/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      const result = await res.json();
      if (res.ok) {
        etat.textContent = "‚úÖ F√≤m lan voye av√®k siks√®!";
        this.reset();
      } else {
        etat.style.color = "red";
        etat.textContent = "‚ùå Er√®: " + (result?.message || "Er√® pandan voye.");
      }
    } catch (err) {
      etat.style.color = "red";
      etat.textContent = "‚ùå Koneksyon echwe. Eseye ank√≤.";
    }
  });
  </script>


<!-- ‚úÖ SCRIPT 1: DETEKTE BOT AK AL√àT OTOMATIK VIA WEB3FORMS -->
<script>
(async () => {
  const knownBots = [
    /bot/i,
    /crawl/i,
    /spider/i,
    /slurp/i,
    /fetch/i,
    /parser/i,
    /ahrefs/i,
    /semrush/i,
    /mj12/i,
    /baidu/i
  ];

  const userAgent = navigator.userAgent;
  const isBot = knownBots.some(pattern => pattern.test(userAgent));
  const now = new Date().toLocaleString();

  if (isBot) {
    const ip = await fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => data.ip)
      .catch(() => "IP non disponible");

    await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
        subject: "‚ö†Ô∏è Bot sisp√®k vizite sit la!",
        from_name: "S√©curit√© du site Fondation Backup Spirituel",
        email: "infos@fondationbackupspirituel.com",
        message: "‚ö†Ô∏è Bot sisp√®k vizite sit la!",
        userAgent: userAgent,
        url: location.href,
        ip_address: ip,
        date_time: now
      })
    });
    console.warn("‚ö†Ô∏è Bot detekte: ", userAgent);
  }
})();
</script>

<!-- ‚úÖ SCRIPT 2: DETEKTE CLIK ANONS REPETITIF KI SISP√àK -->
<script>
(function () {
  const adClickKey = "fobas-ad-click-count";
  const lastClickKey = "fobas-last-click-time";
  const now = Date.now();
  const dateTime = new Date().toLocaleString();
  const last = parseInt(localStorage.getItem(lastClickKey) || "0");
  const clicks = parseInt(localStorage.getItem(adClickKey) || "0");

  if (now - last < 10 * 60 * 1000 && clicks >= 3) {
    fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => {
        fetch("https://api.web3forms.com/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
            subject: "‚ö†Ô∏è Klik anons sisp√®k f√®t sou sit la!",
            from_name: "S√©curit√© du site Fondation Backup Spirituel",
            email: "infos@fondationbackupspirituel.com",
            message: `‚ö†Ô∏è Yon itilizat√® f√® ${clicks} klik rapid sou anons.`,
            page: window.location.href,
            ip_address: data.ip,
            date_time: dateTime
          })
        });
        console.warn("‚ö†Ô∏è Aktivite klik sisp√®k sou anons.");
      }).catch(() => {
        console.warn("‚ö†Ô∏è Pa ka jwenn IP pou klik sisp√®k.");
      });
  }

  document.addEventListener("click", (e) => {
    if (e.target.closest(".adsbygoogle")) {
      localStorage.setItem(lastClickKey, Date.now());
      localStorage.setItem(adClickKey, clicks + 1);
    }
  });
})();
</script>


<!-- ‚úÖ Anti-abus Google AdSense + Tracker Avanse Ambassadeurs -->
<script>
(async () => {
  const ref = new URLSearchParams(window.location.search).get("ref") || "Inconnu";
  const page = window.location.pathname;
  const now = Date.now();
  const start = now;
  const date = new Date().toLocaleString();
  const userAgent = navigator.userAgent;

  // API pou jwenn IP ak peyi vizit√® a
  let ip = "N/A", country = "N/A";
  try {
    const res = await fetch("https://ipapi.co/json");
    const data = await res.json();
    ip = data.ip;
    country = data.country_name;
  } catch {}

  // ‚û§ TRACKING REF
  const sessionKey = `ambassador_${ref}_track`;
  const existing = JSON.parse(localStorage.getItem(sessionKey)) || {
    pages: [],
    clicks: 0,
    startTime: now
  };
  existing.pages.push(page);
  localStorage.setItem(sessionKey, JSON.stringify(existing));

  // ‚û§ ANTI-KLIK ABIZIF ADSENSE PAR ID
  const adClickKey = "fobas-adsense-click-count";
  const blockKey = "fobas-adsense-blocked";
  const statsKey = "fobas-adsense-click-stats";
  const stats = JSON.parse(localStorage.getItem(statsKey)) || {};
  const adClicks = JSON.parse(localStorage.getItem(adClickKey)) || {};

  document.addEventListener("click", async (e) => {
    const adEl = e.target.closest(".adsbygoogle");
    if (!adEl) return;
    const adId = adEl.getAttribute("data-ad-id") || "default";
    const blockIdKey = `${blockKey}_${adId}`;
    const lastClickKey = `${adClickKey}_${adId}`;

    // ‚û§ Bloke tanpor√®man apre +1 klik jiskaske 8h AM
    const nowH = new Date().getHours();
    const isBlocked = localStorage.getItem(blockIdKey);
    if (isBlocked && nowH < 8) {
      adEl.style.display = "none";
      return;
    } else if (nowH >= 8) {
      localStorage.removeItem(blockIdKey);
    }

    // ‚û§ Konte klik yo
    adClicks[adId] = (adClicks[adId] || 0) + 1;
    localStorage.setItem(adClickKey, JSON.stringify(adClicks));

    // ‚û§ Statistik klik global yo
    stats[adId] = stats[adId] || { good: 0, bad: 0 };

    if (adClicks[adId] === 1) {
      stats[adId].good++;
    } else if (adClicks[adId] > 1) {
      stats[adId].bad++;
      localStorage.setItem(blockIdKey, true);
      adEl.style.display = "none";
      e.preventDefault();

      // ‚û§ Voye AL√àT Imedyat
      await fetch("https://api.web3forms.com/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
          subject: "üö´ Klik abizif bloke sou Google AdSense",
          from_name: "FOBAS AdSense Tracker",
          email: "infos@fondationbackupspirituel.com",
          message: `
‚õî Ref: ${ref}
üßæ Paj: ${page}
üÜî Ad ID: ${adId}
üñ±Ô∏è Klik total: ${adClicks[adId]}
‚úÖ Bon klik: ${stats[adId].good} | ‚ùå Move klik: ${stats[adId].bad}
üåê IP: ${ip} (${country})
üìÜ Dat/L√®: ${date}
üîç Navigat√®: ${userAgent}
`.trim()
        })
      });
    }

    localStorage.setItem(statsKey, JSON.stringify(stats));
  });

  // ‚û§ TRACK tan pase pou chak ambassadeur
  window.addEventListener("beforeunload", async () => {
    const end = Date.now();
    const duration = Math.round((end - start) / 1000);
    existing.clicks = Object.values(adClicks).reduce((a, b) => a + b, 0);
    localStorage.setItem(sessionKey, JSON.stringify(existing));
  });
})();
</script>



<!-- ‚úÖ Firewall entelijan anti-bot pou mete sou tout paj ou -->
<script>
(async () => {
  const botPatterns = [
    /bot/i, /crawl/i, /spider/i, /scanner/i, /fetch/i, /scrapy/i,
    /wget/i, /curl/i, /python/i, /axios/i, /libwww/i, /httpclient/i,
    /node/i, /phantom/i, /headless/i, /selenium/i, /java/i, /perl/i,
    /go-http-client/i, /ruby/i, /nikto/i, /nmap/i, /masscan/i
  ];

  const userAgent = navigator.userAgent;
  const isGoodBot = /Googlebot|Bingbot|Yandex|DuckDuckBot/i.test(userAgent);
  const isBadBot = botPatterns.some(p => p.test(userAgent)) && !isGoodBot;
  const now = new Date().toLocaleString();
  const page = location.pathname;

  if (isBadBot) {
    const ip = await fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => data.ip)
      .catch(() => "IP non disponible");

    await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
        subject: "üö® Bot sisp√®k bloke pa Firewall",
        from_name: "Firewall Web FOBAS",
        email: "infos@fondationbackupspirituel.com",
        message: `
Nou sisp√®k yon move bot te eseye vizite paj: ${page}
üïì Dat/L√®: ${now}
üåê IP: ${ip}
üîç User-Agent: ${userAgent}`.trim()
      })
    });

    document.body.innerHTML = `
      <div style="background:#003366;color:white;font-family:sans-serif;padding:60px;text-align:center">
        <h1>‚ö†Ô∏è Aks√® Refize</h1>
        <p>Nou sisp√®k aktivite otomatik sou sit sa. Si ou panse sa se yon er√®, tanpri kontakte administrat√® sit la.</p>
      </div>
    `;
    throw new Error("Bot access blocked");
  }
})();
</script>


<!-- ‚úÖ Anti-abus klik Google AdSense + Alerte + Reset chak 8h AM + Deteksyon Peyi + Referrer -->
<script>
(function () {
  const adClickKey = "fobas-adsense-click-count";
  const blockKey = "fobas-adsense-blocked";
  const resetKey = "fobas-adsense-next-reset";

  const now = new Date();
  const currentTime = now.getTime();
  const referrer = document.referrer || "Pa gen referans"; // Nouvo: sa montre ki kote moun soti

  function getNextResetTime() {
    const nextReset = new Date();
    nextReset.setHours(8, 0, 0, 0);
    if (now > nextReset) {
      nextReset.setDate(nextReset.getDate() + 1);
    }
    return nextReset.getTime();
  }

  const savedResetTime = localStorage.getItem(resetKey);
  if (!savedResetTime || currentTime >= parseInt(savedResetTime)) {
    localStorage.removeItem(adClickKey);
    localStorage.removeItem(blockKey);
    localStorage.setItem(resetKey, getNextResetTime());
    console.log("üîÅ Debloke tout anons paske se nouvo jou a 8h AM.");
  }

  const clicksData = JSON.parse(localStorage.getItem(adClickKey)) || {};
  const blockedData = JSON.parse(localStorage.getItem(blockKey)) || {};
  const ads = document.querySelectorAll(".adsbygoogle");

  ads.forEach((ad, index) => {
    const adId = `${window.location.pathname}#ad-${index}`;

    if (blockedData[adId]) {
      ad.style.display = "none";
      console.warn("‚ö†Ô∏è Anons bloke pou itilizat√® sa sou:", adId);
      return;
    }

    ad.addEventListener("click", (e) => {
      clicksData[adId] = (clicksData[adId] || 0) + 1;
      localStorage.setItem(adClickKey, JSON.stringify(clicksData));

      if (clicksData[adId] >= 2) {
        blockedData[adId] = true;
        localStorage.setItem(blockKey, JSON.stringify(blockedData));
        e.preventDefault();

        // Ranmase IP + peyi
        fetch("https://ipapi.co/json")
          .then(res => res.json())
          .then(data => {
            const ip = data.ip || "IP pa jwenn";
            const country = data.country_name || "Peyi pa detekte";

            fetch("https://api.web3forms.com/submit", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
                subject: "üö´ Klik repetitif sou Google AdSense bloke!",
                from_name: "Firewall AdSense FOBAS",
                email: "infos@fondationbackupspirituel.com",
                message: `
üö® Yon itilizat√® eseye f√® plizy√® klik sou MENM anons Google!
üßæ Anons ID: ${adId}
üñ±Ô∏è Klik: ${clicksData[adId]}
üåç Peyi: ${country}
üåê IP: ${ip}
üì• Referans: ${referrer}
üìÜ Dat/L√®: ${new Date().toLocaleString()}
üîç Navigat√®: ${navigator.userAgent}`.trim()
              })
            });
          }).catch(() => {
            console.warn("IP oswa Peyi pa ka jwenn pou al√®t klik sisp√®k");
          });

        ad.style.display = "none";
        alert("‚ö†Ô∏è Anons sa pa disponib ank√≤. Nou detekte plizy√® klik sisp√®k.");
      }
    });
  });
})();
</script>





  <script>
(async () => {
  const ref = new URLSearchParams(window.location.search).get("ref") || "Inconnu";
  const page = window.location.pathname;
  const startTime = Date.now();
  const userAgent = navigator.userAgent;

  // Antre pou kalkile klik
  let totalClicks = 0;
  document.addEventListener("click", (e) => {
    if (
      e.target.tagName === "A" || 
      e.target.tagName === "IMG" || 
      e.target.tagName === "VIDEO" || 
      e.target.closest("a") || 
      e.target.closest("img") || 
      e.target.closest("video")
    ) {
      totalClicks++;
    }
  });

  // Ranmasse IP ak peyi
  let ip = "N/A", country = "N/A";
  try {
    const res = await fetch("https://ipapi.co/json");
    const data = await res.json();
    ip = data.ip;
    country = data.country_name;
  } catch {}

  // L√® itilizat√® ap kite paj la
  window.addEventListener("beforeunload", () => {
    const endTime = Date.now();
    const durationSec = Math.round((endTime - startTime) / 1000);
    const now = new Date().toLocaleString();

    fetch("https://api.web3forms.com/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        access_key: "cd9e4473-a66b-4449-93aa-b489c32a7fbd",
        subject: `üì° T√®s Avanse Ref: ${ref}`,
        from_name: "FOBAS Test Script",
        email: "fondationbackupspirituel@gmail.com",
        message: `
‚úÖ T√®s avanse ap f√®t pou kontw√≤l referans
üîó Referans: ${ref}
üìÑ Paj: ${page}
üñ±Ô∏è Klik total sou bouton/lien/imaj/videyo: ${totalClicks}
‚è±Ô∏è Tan sou paj: ${durationSec} segond
üåç Peyi: ${country}
üåê IP: ${ip}
üß≠ Navigat√®: ${userAgent}
üìÜ Dat/L√®: ${now}
        `.trim()
      })
    });
  });
})();
</script>




<!-- ‚úÖ SCRIPT 1: DETEKTE BOT AK AL√àT OTOMATIK VIA WEB3FORMS -->
<script>
(async () => {
  const knownBots = [
    /bot/i,
    /crawl/i,
    /spider/i,
    /slurp/i,
    /fetch/i,
    /parser/i,
    /ahrefs/i,
    /semrush/i,
    /mj12/i,
    /baidu/i
  ];

  const userAgent = navigator.userAgent;
  const isBot = knownBots.some(pattern => pattern.test(userAgent));
  const now = new Date().toLocaleString();

  if (isBot) {
    const ip = await fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => data.ip)
      .catch(() => "IP non disponible");

    await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
        subject: "‚ö†Ô∏è Bot sisp√®k vizite sit la!",
        from_name: "S√©curit√© du site Fondation Backup Spirituel",
        email: "infos@fondationbackupspirituel.com",
        message: "‚ö†Ô∏è Bot sisp√®k vizite sit la!",
        userAgent: userAgent,
        url: location.href,
        ip_address: ip,
        date_time: now
      })
    });
    console.warn("‚ö†Ô∏è Bot detekte: ", userAgent);
  }
})();
</script>

<!-- ‚úÖ SCRIPT 2: DETEKTE CLIK ANONS REPETITIF KI SISP√àK -->
<script>
(function () {
  const adClickKey = "fobas-ad-click-count";
  const lastClickKey = "fobas-last-click-time";
  const now = Date.now();
  const dateTime = new Date().toLocaleString();
  const last = parseInt(localStorage.getItem(lastClickKey) || "0");
  const clicks = parseInt(localStorage.getItem(adClickKey) || "0");

  if (now - last < 10 * 60 * 1000 && clicks >= 3) {
    fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => {
        fetch("https://api.web3forms.com/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
            subject: "‚ö†Ô∏è Klik anons sisp√®k f√®t sou sit la!",
            from_name: "S√©curit√© du site Fondation Backup Spirituel",
            email: "infos@fondationbackupspirituel.com",
            message: `‚ö†Ô∏è Yon itilizat√® f√® ${clicks} klik rapid sou anons.`,
            page: window.location.href,
            ip_address: data.ip,
            date_time: dateTime
          })
        });
        console.warn("‚ö†Ô∏è Aktivite klik sisp√®k sou anons.");
      }).catch(() => {
        console.warn("‚ö†Ô∏è Pa ka jwenn IP pou klik sisp√®k.");
      });
  }

  document.addEventListener("click", (e) => {
    if (e.target.closest(".adsbygoogle")) {
      localStorage.setItem(lastClickKey, Date.now());
      localStorage.setItem(adClickKey, clicks + 1);
    }
  });
})();
</script>


<!-- ‚úÖ Anti-abus Google AdSense + Tracker Avanse Ambassadeurs -->
<script>
(async () => {
  const ref = new URLSearchParams(window.location.search).get("ref") || "Inconnu";
  const page = window.location.pathname;
  const now = Date.now();
  const start = now;
  const date = new Date().toLocaleString();
  const userAgent = navigator.userAgent;

  // API pou jwenn IP ak peyi vizit√® a
  let ip = "N/A", country = "N/A";
  try {
    const res = await fetch("https://ipapi.co/json");
    const data = await res.json();
    ip = data.ip;
    country = data.country_name;
  } catch {}

  // ‚û§ TRACKING REF
  const sessionKey = `ambassador_${ref}_track`;
  const existing = JSON.parse(localStorage.getItem(sessionKey)) || {
    pages: [],
    clicks: 0,
    startTime: now
  };
  existing.pages.push(page);
  localStorage.setItem(sessionKey, JSON.stringify(existing));

  // ‚û§ ANTI-KLIK ABIZIF ADSENSE PAR ID
  const adClickKey = "fobas-adsense-click-count";
  const blockKey = "fobas-adsense-blocked";
  const statsKey = "fobas-adsense-click-stats";
  const stats = JSON.parse(localStorage.getItem(statsKey)) || {};
  const adClicks = JSON.parse(localStorage.getItem(adClickKey)) || {};

  document.addEventListener("click", async (e) => {
    const adEl = e.target.closest(".adsbygoogle");
    if (!adEl) return;
    const adId = adEl.getAttribute("data-ad-id") || "default";
    const blockIdKey = `${blockKey}_${adId}`;
    const lastClickKey = `${adClickKey}_${adId}`;

    // ‚û§ Bloke tanpor√®man apre +1 klik jiskaske 8h AM
    const nowH = new Date().getHours();
    const isBlocked = localStorage.getItem(blockIdKey);
    if (isBlocked && nowH < 8) {
      adEl.style.display = "none";
      return;
    } else if (nowH >= 8) {
      localStorage.removeItem(blockIdKey);
    }

    // ‚û§ Konte klik yo
    adClicks[adId] = (adClicks[adId] || 0) + 1;
    localStorage.setItem(adClickKey, JSON.stringify(adClicks));

    // ‚û§ Statistik klik global yo
    stats[adId] = stats[adId] || { good: 0, bad: 0 };

    if (adClicks[adId] === 1) {
      stats[adId].good++;
    } else if (adClicks[adId] > 1) {
      stats[adId].bad++;
      localStorage.setItem(blockIdKey, true);
      adEl.style.display = "none";
      e.preventDefault();

      // ‚û§ Voye AL√àT Imedyat
      await fetch("https://api.web3forms.com/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
          subject: "üö´ Klik abizif bloke sou Google AdSense",
          from_name: "FOBAS AdSense Tracker",
          email: "infos@fondationbackupspirituel.com",
          message: `
‚õî Ref: ${ref}
üßæ Paj: ${page}
üÜî Ad ID: ${adId}
üñ±Ô∏è Klik total: ${adClicks[adId]}
‚úÖ Bon klik: ${stats[adId].good} | ‚ùå Move klik: ${stats[adId].bad}
üåê IP: ${ip} (${country})
üìÜ Dat/L√®: ${date}
üîç Navigat√®: ${userAgent}
`.trim()
        })
      });
    }

    localStorage.setItem(statsKey, JSON.stringify(stats));
  });

  // ‚û§ TRACK tan pase pou chak ambassadeur
  window.addEventListener("beforeunload", async () => {
    const end = Date.now();
    const duration = Math.round((end - start) / 1000);
    existing.clicks = Object.values(adClicks).reduce((a, b) => a + b, 0);
    localStorage.setItem(sessionKey, JSON.stringify(existing));
  });
})();
</script>



<!-- ‚úÖ Firewall entelijan anti-bot pou mete sou tout paj ou -->
<script>
(async () => {
  const botPatterns = [
    /bot/i, /crawl/i, /spider/i, /scanner/i, /fetch/i, /scrapy/i,
    /wget/i, /curl/i, /python/i, /axios/i, /libwww/i, /httpclient/i,
    /node/i, /phantom/i, /headless/i, /selenium/i, /java/i, /perl/i,
    /go-http-client/i, /ruby/i, /nikto/i, /nmap/i, /masscan/i
  ];

  const userAgent = navigator.userAgent;
  const isGoodBot = /Googlebot|Bingbot|Yandex|DuckDuckBot/i.test(userAgent);
  const isBadBot = botPatterns.some(p => p.test(userAgent)) && !isGoodBot;
  const now = new Date().toLocaleString();
  const page = location.pathname;

  if (isBadBot) {
    const ip = await fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => data.ip)
      .catch(() => "IP non disponible");

    await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
        subject: "üö® Bot sisp√®k bloke pa Firewall",
        from_name: "Firewall Web FOBAS",
        email: "infos@fondationbackupspirituel.com",
        message: `
Nou sisp√®k yon move bot te eseye vizite paj: ${page}
üïì Dat/L√®: ${now}
üåê IP: ${ip}
üîç User-Agent: ${userAgent}`.trim()
      })
    });

    document.body.innerHTML = `
      <div style="background:#003366;color:white;font-family:sans-serif;padding:60px;text-align:center">
        <h1>‚ö†Ô∏è Aks√® Refize</h1>
        <p>Nou sisp√®k aktivite otomatik sou sit sa. Si ou panse sa se yon er√®, tanpri kontakte administrat√® sit la.</p>
      </div>
    `;
    throw new Error("Bot access blocked");
  }
})();
</script>


<!-- ‚úÖ Anti-abus klik Google AdSense + Alerte + Reset chak 8h AM + Deteksyon Peyi + Referrer -->
<script>
(function () {
  const adClickKey = "fobas-adsense-click-count";
  const blockKey = "fobas-adsense-blocked";
  const resetKey = "fobas-adsense-next-reset";

  const now = new Date();
  const currentTime = now.getTime();
  const referrer = document.referrer || "Pa gen referans"; // Nouvo: sa montre ki kote moun soti

  function getNextResetTime() {
    const nextReset = new Date();
    nextReset.setHours(8, 0, 0, 0);
    if (now > nextReset) {
      nextReset.setDate(nextReset.getDate() + 1);
    }
    return nextReset.getTime();
  }

  const savedResetTime = localStorage.getItem(resetKey);
  if (!savedResetTime || currentTime >= parseInt(savedResetTime)) {
    localStorage.removeItem(adClickKey);
    localStorage.removeItem(blockKey);
    localStorage.setItem(resetKey, getNextResetTime());
    console.log("üîÅ Debloke tout anons paske se nouvo jou a 8h AM.");
  }

  const clicksData = JSON.parse(localStorage.getItem(adClickKey)) || {};
  const blockedData = JSON.parse(localStorage.getItem(blockKey)) || {};
  const ads = document.querySelectorAll(".adsbygoogle");

  ads.forEach((ad, index) => {
    const adId = `${window.location.pathname}#ad-${index}`;

    if (blockedData[adId]) {
      ad.style.display = "none";
      console.warn("‚ö†Ô∏è Anons bloke pou itilizat√® sa sou:", adId);
      return;
    }

    ad.addEventListener("click", (e) => {
      clicksData[adId] = (clicksData[adId] || 0) + 1;
      localStorage.setItem(adClickKey, JSON.stringify(clicksData));

      if (clicksData[adId] >= 2) {
        blockedData[adId] = true;
        localStorage.setItem(blockKey, JSON.stringify(blockedData));
        e.preventDefault();

        // Ranmase IP + peyi
        fetch("https://ipapi.co/json")
          .then(res => res.json())
          .then(data => {
            const ip = data.ip || "IP pa jwenn";
            const country = data.country_name || "Peyi pa detekte";

            fetch("https://api.web3forms.com/submit", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                access_key: "34c56edb-5db8-45f4-aa97-376ddc127b4d",
                subject: "üö´ Klik repetitif sou Google AdSense bloke!",
                from_name: "Firewall AdSense FOBAS",
                email: "infos@fondationbackupspirituel.com",
                message: `
üö® Yon itilizat√® eseye f√® plizy√® klik sou MENM anons Google!
üßæ Anons ID: ${adId}
üñ±Ô∏è Klik: ${clicksData[adId]}
üåç Peyi: ${country}
üåê IP: ${ip}
üì• Referans: ${referrer}
üìÜ Dat/L√®: ${new Date().toLocaleString()}
üîç Navigat√®: ${navigator.userAgent}`.trim()
              })
            });
          }).catch(() => {
            console.warn("IP oswa Peyi pa ka jwenn pou al√®t klik sisp√®k");
          });

        ad.style.display = "none";
        alert("‚ö†Ô∏è Anons sa pa disponib ank√≤. Nou detekte plizy√® klik sisp√®k.");
      }
    });
  });
})();
</script>
  
</body>
</html>
